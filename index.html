<!doctype html>
<html>
<head>
  <title>Arogi Maximal Cover</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
  <link rel="stylesheet" href="leaflet/leaflet.css" />
  <link rel="stylesheet" href="arogi_dark.css" />
  <script src="leaflet/leaflet.js"></script>
  <script src="https://mapzen.com/tangram/0.6/tangram.min.js"></script>
  <script src="ajax_functions.js"></script>
  <!-- // this loads a geojson of starting points.
  // the variable is called defaultMarkers -->
  <script src="data/mclp_data_500.js"></script>


  <style>

  body {
    padding: 0;
    margin: 0;
  }

  #map {
    height: 100%;
    width: 100%;
    padding:0px;
    margin:0px;
    position: absolute;
  }

  </style>
</head>

<body>
  <div id="map"></div>

  <div id="arogi-menu-main">
    <div id="arogi-control-zone"><img id="three-dots" src="images/dots.svg" /></div>

    <div id="arogi-top-zone">Maximal Cover</div>
    <div id="arogi-menu-upper">Parameters</div>

    <div id="arogi-menu-middle">

      <span class="parameterLabels">facilities</span><br />
      <input type="range" id="pSlider" autocomplete="off" min="1" max="10" step="1" value="7" style="width: 75%;"
      oninput="document.getElementById('myPValue').innerHTML = this.value;">
      <span class="sliderValue" id="myPValue">7</span>

      <p />

      <span class="parameterLabels">distance (km)</span><br />
      <input type="range" id="distanceSlider" autocomplete="off" min="0" max="20" step="0.2" value="10" style="width: 75%;"
      oninput="document.getElementById('myDistanceValue').innerHTML = this.value;">
      <span class="sliderValue" id="myDistanceValue">10</span>

    </div>

    <div id="arogi-menu-bottom">
      <div id="arogi-sub-left">Demand Covered<br /><span id="solutionQuality"></span></div>
    </div>
  </div>



  <script>

  $(document).ready(function() {

    // test circle
    circleArray = new Array();
    redDots = new Array();
    simpleCount = 0;
    var pointMarkers;

    mclpAjaxTrigger();

    $("#pSlider").on('change', function(){
      // call the following function to send the parameters to the solution-makin' script
      mclpAjaxTrigger();
    });

    $("#distanceSlider").on('change', function(){
      // call the following function to send the parameters to the solution-makin' script
      mclpAjaxTrigger();
    });

    // toggle the menus on and off
    $('#arogi-top-zone').click(function(){
      $('#arogi-menu-upper').toggle();
      $('#arogi-menu-middle').toggle();
      $('#arogi-menu-bottom').toggle();
    });

    // toggle the menus on and off
    $('#three-dots').click(function(){
      alert('click!');
    });



  });


  // add basemap tiles from Mapzen's Tangram
  var map = L.map('map', {zoomControl: false});
  var layer = Tangram.leafletLayer({
    scene: 'grayprint.yaml',
    attribution: '<a href="arogi.com">Arogi</a> | &copy; <a href="http://osm.org">OpenSteetMap</a> | <a href="https://mapzen.com/tangram" target="_blank">Mapzen</a>'
  });
  layer.addTo(map);
  map.attributionControl.setPrefix(""); // Leaflet prefix removed to afford an ordering change.

  L.control.scale().setPosition('bottomright').addTo(map);
  new L.Control.Zoom({ position: 'bottomright' }).addTo(map);


  // this gets called on document.ready since the map needs a bounding area and
  // the initial ajax call might take a long time.
  answeredGeoJson = defaultMarkers;
  var pointMarkers = L.geoJson(answeredGeoJson, {
    pointToLayer: function (feature, latlng) {
      return L.circleMarker(latlng);
    }
  });
  // but the points do not need to be shown
  //pointMarkers.addTo(map);

  map.fitBounds(pointMarkers, {padding:[140,140]});

  </script>

</body>

</html>
